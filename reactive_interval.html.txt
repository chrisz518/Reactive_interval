<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reactive 21s Interval</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #111;
    color: #fff;
    text-align: center;
    padding-top: 60px;
  }
  button {
    font-size: 26px;
    padding: 18px 36px;
    border-radius: 12px;
    border: none;
    background: #00c853;
    color: black;
  }
  #status {
    margin-top: 30px;
    font-size: 22px;
  }
</style>
</head>

<body>

<h1>Reactive 21-Second Interval</h1>
<button onclick="startInterval()">START</button>
<div id="status">Ready</div>

<script>
let audioCtx;

function beep(duration = 150, frequency = 900) {
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.frequency.value = frequency;
  gain.gain.value = 0.4;
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.start();
  setTimeout(() => osc.stop(), duration);
}

function rand(min, max) {
  return Math.random() * (max - min) + min;
}

function startInterval() {
  if (!audioCtx) {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  }

  document.getElementById("status").innerText = "Get Readyâ€¦";

  const preDelay = rand(3, 6) * 1000;

  setTimeout(() => {
    beep();
    document.getElementById("status").innerText = "GO";

    setTimeout(() => beep(150, 1100), rand(5, 9) * 1000);
    setTimeout(() => beep(150, 1100), rand(12, 16) * 1000);

    setTimeout(() => {
      beep(300, 600);
      document.getElementById("status").innerText = "STOP";
    }, 21000);

  }, preDelay);
}
</script>

</body>
</html>